<span class="lang-en">
<p>Score : <var>1200</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>2N</var> balls in the <var>xy</var>-plane. The coordinates of the <var>i</var>-th of them is <var>(x_i, y_i)</var>.
Here, <var>x_i</var> and <var>y_i</var> are integers between <var>1</var> and <var>N</var> (inclusive) for all <var>i</var>, and no two balls occupy the same coordinates.</p>
<p>In order to collect these balls, Snuke prepared <var>2N</var> robots, <var>N</var> of type A and <var>N</var> of type B.
Then, he placed the type-A robots at coordinates <var>(1, 0), (2, 0), ..., (N, 0)</var>, and the type-B robots at coordinates <var>(0, 1), (0, 2), ..., (0, N)</var>, one at each position.</p>
<p>When activated, each type of robot will operate as follows.</p>
<ul>
<li>
<p>When a type-A robot is activated at coordinates <var>(a, 0)</var>, it will move to the position of the ball with the lowest <var>y</var>-coordinate among the balls on the line <var>x = a</var>, collect the ball and deactivate itself. If there is no such ball, it will just deactivate itself without doing anything.</p>
</li>
<li>
<p>When a type-B robot is activated at coordinates <var>(0, b)</var>, it will move to the position of the ball with the lowest <var>x</var>-coordinate among the balls on the line <var>y = b</var>, collect the ball and deactivate itself. If there is no such ball, it will just deactivate itself without doing anything.</p>
</li>
</ul>
<p>Once deactivated, a robot cannot be activated again. Also, while a robot is operating, no new robot can be activated until the operating robot is deactivated.</p>
<p>When Snuke was about to activate a robot, he noticed that he may fail to collect all the balls, depending on the order of activating the robots.</p>
<p>Among the <var>(2N)!</var> possible orders of activating the robots, find the number of the ones such that all the balls can be collected, modulo <var>1</var> <var>000</var> <var>000</var> <var>007</var>.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>1 \leq x_i \leq N</var></li>
<li><var>1 \leq y_i \leq N</var></li>
<li>If <var>i ≠ j</var>, either <var>x_i ≠ x_j</var> or <var>y_i ≠ y_j</var>.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Inputs</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>x_1</var> <var>y_1</var>
<var>...</var>
<var>x_{2N}</var> <var>y_{2N}</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Outputs</h3><p>Print the number of the orders of activating the robots such that all the balls can be collected, modulo <var>1</var> <var>000</var> <var>000</var> <var>007</var>.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>2
1 1
1 2
2 1
2 2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>8
</pre>
<p>We will refer to the robots placed at <var>(1, 0)</var> and <var>(2, 0)</var> as A1 and A2, respectively, and the robots placed at <var>(0, 1)</var> and <var>(0, 2)</var> as B1 and B2, respectively.
There are eight orders of activation that satisfy the condition, as follows:</p>
<ul>
<li>A1, B1, A2, B2</li>
<li>A1, B1, B2, A2</li>
<li>A1, B2, B1, A2</li>
<li>A2, B1, A1, B2</li>
<li>B1, A1, B2, A2</li>
<li>B1, A1, A2, B2</li>
<li>B1, A2, A1, B2</li>
<li>B2, A1, B1, A2</li>
</ul>
<p>Thus, the output should be <var>8</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4
3 2
1 2
4 1
4 2
2 2
4 4
2 1
1 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>7392
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>4
1 1
2 2
3 3
4 4
1 2
2 1
3 4
4 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>4480
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>8
6 2
5 1
6 8
7 8
6 5
5 7
4 3
1 4
7 6
8 3
2 8
3 6
3 2
8 5
1 5
5 8
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>82060779
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 5</h3><pre>3
1 1
1 2
1 3
2 1
2 2
2 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 5</h3><pre>0
</pre>
<p>When there is no order of activation that satisfies the condition, the output should be <var>0</var>.</p></section>
</div>
</span>