<span class="lang-en">
<p>Score : <var>2100</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>There are <var>N</var> jewelry shops numbered <var>1</var> to <var>N</var>.</p>
<p>Shop <var>i</var> (<var>1 \leq i \leq N</var>) sells <var>K_i</var> kinds of jewels.
The <var>j</var>-th of these jewels (<var>1 \leq j \leq K_i</var>) has a size and price of <var>S_{i,j}</var> and <var>P_{i,j}</var>, respectively, and the shop has <var>C_{i,j}</var> jewels of this kind in stock.</p>
<p>A jewelry box is said to be <em>good</em> if it satisfies all of the following conditions:</p>
<ul>
<li>For each of the jewelry shops, the box contains one jewel purchased there.</li>
<li>All of the following <var>M</var> restrictions are met.<ul>
<li>Restriction <var>i</var> (<var>1 \leq i \leq M</var>): <var>(</var>The size of the jewel purchased at Shop <var>V_i</var><var>)\leq (</var>The size of the jewel purchased at Shop <var>U_i</var><var>)+W_i</var></li>
</ul>
</li>
</ul>
<p>Answer <var>Q</var> questions.
In the <var>i</var>-th question, given an integer <var>A_i</var>, find the minimum total price of jewels that need to be purchased to make <var>A_i</var> good jewelry boxes. If it is impossible to make <var>A_i</var> good jewelry boxes, report that fact.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N \leq 30</var></li>
<li><var>1 \leq K_i \leq 30</var></li>
<li><var>1 \leq S_{i,j} \leq 10^9</var></li>
<li><var>1 \leq P_{i,j} \leq 30</var></li>
<li><var>1 \leq C_{i,j} \leq 10^{12}</var></li>
<li><var>0 \leq M \leq 50</var></li>
<li><var>1 \leq U_i,V_i \leq N</var></li>
<li><var>U_i \neq V_i</var></li>
<li><var>0 \leq W_i \leq 10^9</var></li>
<li><var>1 \leq Q \leq 10^5</var></li>
<li><var>1 \leq A_i \leq 3 \times 10^{13}</var></li>
<li>All values in input are integers.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
Description of Shop <var>1</var>
Description of Shop <var>2</var>
<var>\vdots</var>
Description of Shop <var>N</var>
<var>M</var>
<var>U_1</var> <var>V_1</var> <var>W_1</var>
<var>U_2</var> <var>V_2</var> <var>W_2</var>
<var>\vdots</var>
<var>U_M</var> <var>V_M</var> <var>W_M</var>
<var>Q</var>
<var>A_1</var>
<var>A_2</var>
<var>\vdots</var>
<var>A_Q</var>
</pre>
<p>The description of Shop <var>i</var> (<var>1 \leq i \leq N</var>) is in the following format:</p>
<pre><var>K_i</var>
<var>S_{i,1}</var> <var>P_{i,1}</var> <var>C_{i,1}</var>
<var>S_{i,2}</var> <var>P_{i,2}</var> <var>C_{i,2}</var>
<var>\vdots</var>
<var>S_{i,K_i}</var> <var>P_{i,K_i}</var> <var>C_{i,K_i}</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print <var>Q</var> lines.
The <var>i</var>-th line should contain the minimum total price of jewels that need to be purchased to make <var>A_i</var> good jewelry boxes, or <var>-1</var> if it is impossible to make them.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
2
1 10 1
3 1 1
3
1 10 1
2 1 1
3 10 1
2
1 1 1
3 10 1
2
1 2 0
2 3 0
3
1
2
3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
42
-1
</pre>
<p>Let <var>(i,j)</var> represent the <var>j</var>-th jewel sold at Shop <var>i</var>.
The answer to each query is as follows:</p>
<ul>
<li><var>A_1=1</var>: Making a box with <var>(1,2),(2,2),(3,1)</var> costs <var>1+1+1=3</var>, which is optimal.</li>
<li><var>A_2=2</var>: Making a box with <var>(1,1),(2,1),(3,1)</var> and another with <var>(1,2),(2,3),(3,2)</var> costs <var>(10+10+1)+(1+10+10)=42</var>, which is optimal.</li>
<li><var>A_3=3</var>: We cannot make three good boxes.</li>
</ul>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5
5
86849520 30 272477201869
968023357 28 539131386006
478355090 8 194500792721
298572419 6 894877901270
203794105 25 594579473837
5
730211794 22 225797976416
842538552 9 420531931830
871332982 26 81253086754
553846923 29 89734736118
731788040 13 241088716205
5
903534485 22 140045153776
187101906 8 145639722124
513502442 9 227445343895
499446330 6 719254728400
564106748 20 333423097859
5
332809289 8 640911722470
969492694 21 937931959818
207959501 11 217019915462
726936503 12 382527525674
887971218 17 552919286358
5
444983655 13 487875689585
855863581 6 625608576077
885012925 10 105520979776
980933856 1 711474069172
653022356 19 977887412815
10
1 2 231274893
2 3 829836076
3 4 745221482
4 5 935448462
5 1 819308546
3 5 815839350
5 3 513188748
3 1 968283437
2 3 202352515
4 3 292999238
10
510266667947
252899314976
510266667948
374155726828
628866122125
628866122123
1
628866122124
510266667949
30000000000000
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>26533866733244
13150764378752
26533866733296
19456097795056
-1
33175436167096
52
33175436167152
26533866733352
-1
</pre></section>
</div>
</span>