<span class="lang-en">
<p>Score : <var>1300</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>A museum exhibits <var>N</var> jewels, Jewel <var>1, 2, ..., N</var>.
The coordinates of Jewel <var>i</var> are <var>(x_i, y_i)</var> (the museum can be regarded as a two-dimensional plane), and the value of that jewel is <var>v_i</var>.</p>
<p>Snuke the thief will steal some of these jewels.</p>
<p>There are <var>M</var> conditions, Condition <var>1, 2, ..., M</var>, that must be met when stealing jewels, or he will be caught by the detective.
Each condition has one of the following four forms:</p>
<ul>
<li>(<var>t_i</var> =<code>L</code>, <var>a_i</var>, <var>b_i</var>) : Snuke can only steal at most <var>b_i</var> jewels whose <var>x</var> coordinates are <var>a_i</var> or smaller.</li>
<li>(<var>t_i</var> =<code>R</code>, <var>a_i</var>, <var>b_i</var>) : Snuke can only steal at most <var>b_i</var> jewels whose <var>x</var> coordinates are <var>a_i</var> or larger.</li>
<li>(<var>t_i</var> =<code>D</code>, <var>a_i</var>, <var>b_i</var>) : Snuke can only steal at most <var>b_i</var> jewels whose <var>y</var> coordinates are <var>a_i</var> or smaller.</li>
<li>(<var>t_i</var> =<code>U</code>, <var>a_i</var>, <var>b_i</var>) : Snuke can only steal at most <var>b_i</var> jewels whose <var>y</var> coordinates are <var>a_i</var> or larger.</li>
</ul>
<p>Find the maximum sum of values of jewels that Snuke the thief can steal.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N \leq 80</var></li>
<li><var>1 \leq x_i, y_i \leq 100</var></li>
<li><var>1 \leq v_i \leq 10^{15}</var></li>
<li><var>1 \leq M \leq 320</var></li>
<li><var>t_i</var> is <code>L</code>, <code>R</code>, <code>U</code> or <code>D</code>.</li>
<li><var>1 \leq a_i \leq 100</var></li>
<li><var>0 \leq b_i \leq N - 1</var></li>
<li><var>(x_i, y_i)</var> are pairwise distinct.</li>
<li><var>(t_i, a_i)</var> are pairwise distinct.</li>
<li><var>(t_i, b_i)</var> are pairwise distinct.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>x_1</var> <var>y_1</var> <var>v_1</var>
<var>x_2</var> <var>y_2</var> <var>v_2</var>
<var>:</var>
<var>x_N</var> <var>y_N</var> <var>v_N</var>
<var>M</var>
<var>t_1</var> <var>a_1</var> <var>b_1</var>
<var>t_2</var> <var>a_2</var> <var>b_2</var>
<var>:</var>
<var>t_M</var> <var>a_M</var> <var>b_M</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the maximum sum of values of jewels that Snuke the thief can steal.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>7
1 3 6
1 5 9
3 1 8
4 3 8
6 2 9
5 4 11
5 7 10
4
L 3 1
R 2 3
D 5 3
U 4 2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>36
</pre>
<p><img alt="Figure" src="https://img.atcoder.jp/agc031/rghe0iwfjoievjw4epdfmengow.png"/></p>
<p>Stealing Jewel <var>1, 5, 6</var> and <var>7</var> results in the total value of <var>36</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3
1 2 3
4 5 6
7 8 9
1
L 100 0
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>4
1 1 10
1 2 11
2 1 12
2 2 13
3
L 8 3
L 9 2
L 10 1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>13
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10
66 47 71040136000
65 77 74799603000
80 53 91192869000
24 34 24931901000
91 78 49867703000
68 71 46108236000
46 73 74799603000
56 63 93122668000
32 51 71030136000
51 26 70912345000
21
L 51 1
L 7 0
U 47 4
R 92 0
R 91 1
D 53 2
R 65 3
D 13 0
U 63 3
L 68 3
D 47 1
L 91 5
R 32 4
L 66 2
L 80 4
D 77 4
U 73 1
D 78 5
U 26 5
R 80 2
R 24 5
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>305223377000
</pre></section>
</div>
</span>