<span class="lang-en">
<p>Score : <var>1500</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>Takahashi loves walking on a tree.
The tree where Takahashi walks has <var>N</var> vertices numbered <var>1</var> through <var>N</var>.
The <var>i</var>-th of the <var>N-1</var> edges connects Vertex <var>a_i</var> and Vertex <var>b_i</var>.</p>
<p>Takahashi has scheduled <var>M</var> walks. The <var>i</var>-th walk is done as follows:</p>
<ul>
<li>The walk involves two vertices <var>u_i</var> and <var>v_i</var> that are fixed beforehand.</li>
<li>Takahashi will walk from <var>u_i</var> to <var>v_i</var> or from <var>v_i</var> to <var>u_i</var> along the shortest path.</li>
</ul>
<p>The <em>happiness</em> gained from the <var>i</var>-th walk is defined as follows:</p>
<ul>
<li>The happiness gained is the number of the edges traversed during the <var>i</var>-th walk that satisfies one of the following conditions:<ul>
<li>In the previous walks, the edge has never been traversed.</li>
<li>In the previous walks, the edge has only been traversed in the direction opposite to the direction taken in the <var>i</var>-th walk.</li>
</ul>
</li>
</ul>
<p>Takahashi would like to decide the direction of each walk so that the total happiness gained from the <var>M</var> walks is maximized.
Find the maximum total happiness that can be gained, and one specific way to choose the directions of the walks that maximizes the total happiness.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 ≤ N,M ≤ 2000</var></li>
<li><var>1 ≤ a_i , b_i ≤ N</var></li>
<li><var>1 ≤ u_i , v_i ≤ N</var></li>
<li><var>a_i \neq b_i</var></li>
<li><var>u_i \neq v_i</var></li>
<li>The graph given as input is a tree.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var>
<var>a_1</var> <var>b_1</var>
:
<var>a_{N-1}</var> <var>b_{N-1}</var>
<var>u_1</var> <var>v_1</var>
:
<var>u_M</var> <var>v_M</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the maximum total happiness <var>T</var> that can be gained, and one specific way to choose the directions of the walks that maximizes the total happiness, in the following format:</p>
<pre><var>T</var>
<var>u^'_1</var> <var>v^'_1</var>
:
<var>u^'_M</var> <var>v^'_M</var>
</pre>
<p>where (<var>u^'_i</var>,<var>v^'_i</var>) is either (<var>u_i</var>,<var>v_i</var>) or (<var>v_i</var>,<var>u_i</var>), which means that the <var>i</var>-th walk is from vertex <var>u^'_i</var> to <var>v^'_i</var>.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>4 3
2 1
3 1
4 1
2 3
3 4
4 2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>6
2 3
3 4
4 2
</pre>
<p>If we decide the directions of the walks as above, he gains the happiness of <var>2</var> in each walk, and the total happiness will be <var>6</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5 3
1 2
1 3
3 4
3 5
2 4
3 5
1 5
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>6
2 4
3 5
5 1
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>6 4
1 2
2 3
1 4
4 5
4 6
2 4
3 6
5 6
4 5
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>9
2 4
6 3
5 6
4 5
</pre></section>
</div>
</span>