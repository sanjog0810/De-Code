<span class="lang-en">
<p>Score : <var>400</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>We have a grid with <var>H</var> rows and <var>W</var> columns. The square at the <var>i</var>-th row and the <var>j</var>-th column will be called Square <var>(i,j)</var>.</p>
<p>The integers from <var>1</var> through <var>H×W</var> are written throughout the grid, and the integer written in Square <var>(i,j)</var> is <var>A_{i,j}</var>.</p>
<p>You, a magical girl, can teleport a piece placed on Square <var>(i,j)</var> to Square <var>(x,y)</var> by consuming <var>|x-i|+|y-j|</var> magic points.</p>
<p>You now have to take <var>Q</var> practical tests of your ability as a magical girl.</p>
<p>The <var>i</var>-th test will be conducted as follows:</p>
<ul>
<li>
<p>Initially, a piece is placed on the square where the integer <var>L_i</var> is written.</p>
</li>
<li>
<p>Let <var>x</var> be the integer written in the square occupied by the piece. Repeatedly move the piece to the square where the integer <var>x+D</var> is written, as long as <var>x</var> is not <var>R_i</var>. The test ends when <var>x=R_i</var>.</p>
</li>
<li>
<p>Here, it is guaranteed that <var>R_i-L_i</var> is a multiple of <var>D</var>.</p>
</li>
</ul>
<p>For each test, find the sum of magic points consumed during that test.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq H,W \leq 300</var></li>
<li><var>1 \leq D \leq H×W</var></li>
<li><var>1 \leq A_{i,j} \leq H×W</var></li>
<li><var>A_{i,j} \neq A_{x,y} ((i,j) \neq (x,y))</var></li>
<li><var>1 \leq Q \leq 10^5</var></li>
<li><var>1 \leq L_i \leq R_i \leq H×W</var></li>
<li><var>(R_i-L_i)</var> is a multiple of <var>D</var>.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>H</var> <var>W</var> <var>D</var>
<var>A_{1,1}</var> <var>A_{1,2}</var> <var>...</var> <var>A_{1,W}</var>
<var>:</var>
<var>A_{H,1}</var> <var>A_{H,2}</var> <var>...</var> <var>A_{H,W}</var>
<var>Q</var>
<var>L_1</var> <var>R_1</var>
<var>:</var>
<var>L_Q</var> <var>R_Q</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>For each test, print the sum of magic points consumed during that test.</p>
<p>Output should be in the order the tests are conducted.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 3 2
1 4 3
2 5 7
8 9 6
1
4 8
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>5
</pre>
<ul>
<li>
<p><var>4</var> is written in Square <var>(1,2)</var>.</p>
</li>
<li>
<p><var>6</var> is written in Square <var>(3,3)</var>.</p>
</li>
<li>
<p><var>8</var> is written in Square <var>(3,1)</var>.</p>
</li>
</ul>
<p>Thus, the sum of magic points consumed during the first test is <var>(|3-1|+|3-2|)+(|3-3|+|1-3|)=5</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4 2 3
3 7
1 4
5 2
6 8
2
2 2
2 2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
0
</pre>
<p>Note that there may be a test where the piece is not moved at all, and there may be multiple identical tests.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5 5 4
13 25 7 15 17
16 22 20 2 9
14 11 12 1 19
10 6 23 8 18
3 21 5 24 4
3
13 13
2 10
13 13
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
5
0
</pre></section>
</div>
</span>