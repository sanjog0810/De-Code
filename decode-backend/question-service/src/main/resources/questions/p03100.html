<span class="lang-en">
<p>Score : <var>2000</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>You are given a connected graph with <var>N</var> vertices and <var>M</var> edges. The vertices are numbered <var>1</var> to <var>N</var>. The <var>i</var>-th edge is an undirected edge of length <var>C_i</var> connecting Vertex <var>A_i</var> and Vertex <var>B_i</var>.</p>
<p>Additionally, an odd number <var>MOD</var> is given.</p>
<p>You will be given <var>Q</var> queries, which should be processed. The queries take the following form:</p>
<ul>
<li>Given in the <var>i</var>-th query are <var>S_i</var>, <var>T_i</var> and <var>R_i</var>. Print <code>YES</code> if there exists a path from Vertex <var>S_i</var> to Vertex <var>T_i</var> whose length is <var>R_i</var> modulo <var>MOD</var>, and print <code>NO</code> otherwise. A path may traverse the same edge multiple times, or go back using the edge it just used.</li>
</ul>
<p>Here, in this problem, the length of a path is <font color="red"><strong>NOT</strong></font> the sum of the lengths of its edges themselves, but the length of the first edge used in the path gets multiplied by <var>1</var>, the second edge gets multiplied by <var>2</var>, the third edge gets multiplied by <var>4</var>, and so on. (More formally, let <var>L_1,...,L_k</var> be the lengths of the edges used, in this order. The length of that path is the sum of <var>L_i \times 2^{i-1}</var>.)</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N,M,Q \leq 50000</var></li>
<li><var>3 \leq MOD \leq 10^{6}</var></li>
<li><var>MOD</var> is odd.</li>
<li><var>1 \leq A_i,B_i\leq N</var></li>
<li><var>0 \leq C_i \leq MOD-1</var></li>
<li><var>1 \leq S_i,T_i \leq N</var></li>
<li><var>0 \leq R_i \leq MOD-1</var></li>
<li>The given graph is connected. (It may contain self-loops or multiple edges.)</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var> <var>Q</var> <var>MOD</var>
<var>A_1</var> <var>B_1</var> <var>C_1</var>
<var>\vdots</var>
<var>A_M</var> <var>B_M</var> <var>C_M</var>
<var>S_1</var> <var>T_1</var> <var>R_1</var>
<var>\vdots</var>
<var>S_Q</var> <var>T_Q</var> <var>R_Q</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the answers to the <var>i</var>-th query in the <var>i</var>-th line.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 2 2 2019
1 2 1
2 3 2
1 3 5
1 3 4
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>YES
NO
</pre>
<p>The answer to each query is as follows:</p>
<ul>
<li>The first query: If we take the path <var>1,2,3</var>, its length is <var>1 \times 2^0 + 2 \times 2^1 = 5</var>, so there exists a path whose length is <var>5</var> modulo <var>2019</var>. The answer is <code>YES</code>.</li>
<li>The second query: No matter what path we take from Vertex <var>1</var> to Vertex <var>3</var>, its length will never be <var>4</var> modulo <var>2019</var>. The answer is <code>NO</code>.</li>
</ul>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>6 6 3 2019
1 2 4
2 3 4
3 4 4
4 5 4
5 6 4
6 1 4
2 6 1110
3 1 1111
4 5 1112
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>YES
NO
NO
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>1 2 3 25
1 1 1
1 1 2
1 1 13
1 1 6
1 1 14
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>YES
YES
YES
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>10 15 10 15
1 2 1
2 3 6
3 4 6
2 5 1
5 6 1
4 7 6
1 8 11
2 9 6
5 10 11
9 10 11
3 6 1
2 5 1
2 7 11
9 10 11
5 6 11
1 3 5
9 8 3
7 7 7
7 10 13
4 1 10
9 3 12
10 10 14
9 2 1
6 6 5
8 8 4
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>YES
NO
NO
NO
NO
NO
NO
YES
YES
NO
</pre></section>
</div>
</span>