<span class="lang-en">
<p>Score : <var>900</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>You are given a sequence of <var>N</var> integers: <var>A_1,A_2,...,A_N</var>.</p>
<p>Find the number of permutations <var>p_1,p_2,...,p_N</var> of <var>1,2,...,N</var> that can be changed to <var>A_1,A_2,...,A_N</var> by performing the following operation some number of times (possibly zero), modulo <var>998244353</var>:</p>
<ul>
<li>For each <var>1\leq i\leq N</var>, let <var>q_i=min(p_{i-1},p_{i})</var>, where <var>p_0=p_N</var>. Replace the sequence <var>p</var> with the sequence <var>q</var>.</li>
</ul>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N \leq 3 Ã— 10^5</var></li>
<li><var>1 \leq A_i \leq N</var></li>
<li>All values in input are integers.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>A_1</var>
<var>:</var>
<var>A_N</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the number of the sequences that satisfy the condition, modulo <var>998244353</var>.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
1
2
1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>2
</pre>
<p><var>(2,3,1)</var> and <var>(3,2,1)</var> satisfy the condition.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5
3
1
4
1
5
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>8
4
4
4
1
1
1
2
2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>24
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>6
1
1
6
2
2
2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>0
</pre></section>
</div>
</span>