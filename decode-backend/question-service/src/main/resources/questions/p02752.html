<span class="lang-en">
<p>Score : <var>1100</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3>
<p>We have a tree <var>G</var> with <var>N</var> vertices numbered <var>1</var> to <var>N</var>.
The <var>i</var>-th edge of <var>G</var> connects Vertex <var>a_i</var> and Vertex <var>b_i</var>.</p>
<p>Consider adding zero or more edges in <var>G</var>, and let <var>H</var> be the graph resulted.</p>
<p>Find the number of graphs <var>H</var> that satisfy the following conditions, modulo <var>998244353</var>.</p>
<ul>
<li><var>H</var> does not contain self-loops or multiple edges.</li>
<li>The diameters of <var>G</var> and <var>H</var> are equal.</li>
<li>For every pair of vertices in <var>H</var> that is not directly connected by an edge, the addition of an edge directly connecting them would reduce the diameter of the graph.</li>
</ul>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3>
<ul>
<li><var> 3 \le N \le 2 \times 10^5 </var></li>
<li><var> 1 \le a_i, b_i \le N </var></li>
<li>The given graph is a tree.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3>
<p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>a_1</var> <var>b_1</var>
<var>\vdots</var>
<var>a_{N-1}</var> <var>b_{N-1}</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3>
<p>Print the answer.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>6
1 6
2 1
5 2
3 4
2 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
</pre>
<p>For example, adding the edges <var>(1, 5), (3, 5)</var> in <var>G</var> satisfies the conditions.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3
1 2
2 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>1
</pre>
<p>The only graph <var>H</var> that satisfies the conditions is <var>G</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>9
1 2
2 3
4 2
1 7
6 1
2 5
5 9
6 8
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>27
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>19
2 4
15 8
1 16
1 3
12 19
1 18
7 11
11 15
12 9
1 6
7 14
18 2
13 12
13 5
16 13
7 1
11 10
7 17
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>78732
</pre></section>
</div>
</span>