<span class="lang-en">
<p>Score : <var>400</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>Mountaineers Mr. Takahashi and Mr. Aoki recently trekked across a certain famous mountain range.
The mountain range consists of <var>N</var> mountains, extending from west to east in a straight line as Mt. <var>1</var>, Mt. <var>2</var>, ..., Mt. <var>N</var>.
Mr. Takahashi traversed the range from the west and Mr. Aoki from the east.  </p>
<p>The height of Mt. <var>i</var> is <var>h_i</var>, but they have forgotten the value of each <var>h_i</var>.
Instead, for each <var>i</var> (<var>1 ≤ i ≤ N</var>), they recorded the maximum height of the mountains climbed up to the time they reached the peak of Mt. <var>i</var> (including Mt. <var>i</var>).
Mr. Takahashi's record is <var>T_i</var> and Mr. Aoki's record is <var>A_i</var>.  </p>
<p>We know that the height of each mountain <var>h_i</var> is a positive integer.
Compute the number of the possible sequences of the mountains' heights, modulo <var>10^9 + 7</var>.</p>
<p>Note that the records may be incorrect and thus there may be no possible sequence of the mountains' heights.
In such a case, output <var>0</var>.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 ≤ N ≤ 10^5</var></li>
<li><var>1 ≤ T_i ≤ 10^9</var></li>
<li><var>1 ≤ A_i ≤ 10^9</var></li>
<li><var>T_i ≤ T_{i+1}</var> (<var>1 ≤ i ≤ N - 1</var>)</li>
<li><var>A_i ≥ A_{i+1}</var> (<var>1 ≤ i ≤ N - 1</var>)</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>The input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>T_1</var> <var>T_2</var> <var>...</var> <var>T_N</var>
<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_N</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the number of possible sequences of the mountains' heights, modulo <var>10^9 + 7</var>.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>5
1 3 3 3 3
3 3 2 2 2
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>4
</pre>
<p>The possible sequences of the mountains' heights are:</p>
<ul>
<li><var>1, 3, 2, 2, 2</var> </li>
<li><var>1, 3, 2, 1, 2</var> </li>
<li><var>1, 3, 1, 2, 2</var> </li>
<li><var>1, 3, 1, 1, 2</var> </li>
</ul>
<p>for a total of four sequences.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>5
1 1 1 2 2
3 2 1 1 1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>0
</pre>
<p>The records are contradictory, since Mr. Takahashi recorded <var>2</var> as the highest peak after climbing all the mountains but Mr. Aoki recorded <var>3</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>10
1 3776 3776 8848 8848 8848 8848 8848 8848 8848
8848 8848 8848 8848 8848 8848 8848 8848 3776 5
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>884111967
</pre>
<p>Don't forget to compute the number modulo <var>10^9 + 7</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>1
17
17
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>1
</pre>
<p>Some mountain ranges consist of only one mountain.</p></section>
</div>
</span>