<span class="lang-en">
<p>Score : <var>1700</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>Snuke has an integer sequence <var>A</var> whose length is <var>N</var>.
He likes permutations of <var>(1, 2, ..., N)</var>, <var>P</var>, that satisfy the following condition:</p>
<ul>
<li><var>P_i \leq A_i</var> for all <var>i</var> ( <var>1 \leq i \leq N</var> ).</li>
</ul>
<p>Snuke is interested in the inversion numbers of such permutations.
Find the sum of the inversion numbers over all permutations that satisfy the condition.
Since this can be extremely large, compute the sum modulo <var>10^9+7</var>.</p>
</section>
</div>
<div class="part">
<section>
<h3>Notes</h3><p>The <em>inversion number</em> of a sequence <var>Z</var> whose length <var>N</var> is the number of pairs of integers <var>i</var> and <var>j</var> ( <var>1 \leq i &lt; j \leq N</var> ) such that <var>Z_i &gt; Z_j</var>.</p>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N \leq 2 \times 10^5</var></li>
<li><var>1 \leq A_i \leq N</var> ( <var>1 \leq i \leq N</var> )</li>
<li>All values in input are integers.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>A_1</var> <var>A_2</var> <var>...</var> <var>A_N</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the sum of the inversion numbers over all permutations that satisfy the condition.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
2 3 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>4
</pre>
<p>There are four permutations that satisfy the condition: <var>(1,2,3)</var>, <var>(1,3,2)</var>, <var>(2,1,3)</var> and <var>(2,3,1)</var>.
The inversion numbers of these permutations are <var>0</var>, <var>1</var>, <var>1</var> and <var>2</var>, respectively, for a total of <var>4</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>6
4 2 5 1 6 3
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>7
</pre>
<p>Only one permutation <var>(4,2,5,1,6,3)</var> satisfies the condition.
The inversion number of this permutation is <var>7</var>, so the answer is <var>7</var>.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5
4 4 4 4 4
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
</pre>
<p>No permutation satisfies the condition.</p>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>30
22 30 15 20 10 29 11 29 28 11 26 10 18 28 22 5 29 16 24 24 27 10 21 30 29 19 28 27 18 23
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>848414012
</pre></section>
</div>
</span>