<span class="lang-en">
<p>Score : <var>900</var> points</p>
<div class="part">
<section>
<h3>Problem Statement</h3><p>Takahashi has an <var>N \times N</var> grid. The square at the <var>i</var>-th row and the <var>j</var>-th column of the grid is denoted by <var>(i,j)</var>.
Particularly, the top-left square of the grid is <var>(1,1)</var>, and the bottom-right square is <var>(N,N)</var>.</p>
<p>An integer, <var>0</var> or <var>1</var>, is written on <var>M</var> of the squares in the Takahashi's grid.
Three integers <var>a_i,b_i</var> and <var>c_i</var> describe the <var>i</var>-th of those squares with integers written on them: the integer <var>c_i</var> is written on the square <var>(a_i,b_i)</var>.</p>
<p>Takahashi decides to write an integer, <var>0</var> or <var>1</var>, on each of the remaining squares so that the condition below is satisfied.
Find the number of such ways to write integers, modulo <var>998244353</var>.</p>
<ul>
<li>For all <var>1\leq i &lt; j\leq N</var>, there are even number of <var>1</var>s in the square region whose top-left square is <var>(i,i)</var> and whose bottom-right square is <var>(j,j)</var>.</li>
</ul>
</section>
</div>
<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>2 \leq N \leq 10^5</var></li>
<li><var>0 \leq M \leq min(5 \times 10^4,N^2)</var></li>
<li><var>1 \leq a_i,b_i \leq N(1\leq i\leq M)</var></li>
<li><var>0 \leq c_i \leq 1(1\leq i\leq M)</var></li>
<li>If <var>i \neq j</var>, then <var>(a_i,b_i) \neq (a_j,b_j)</var>.</li>
<li>All values in input are integers.</li>
</ul>
</section>
</div>
<hr/>
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var>
<var>a_1</var> <var>b_1</var> <var>c_1</var>
<var>:</var>
<var>a_M</var> <var>b_M</var> <var>c_M</var>
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Output</h3><p>Print the number of possible ways to write integers, modulo <var>998244353</var>.</p>
</section>
</div>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3 3
1 1 1
3 1 0
2 3 1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 1</h3><pre>8
</pre>
<p>For example, the following ways to write integers satisfy the condition:</p>
<pre>101   111
011   111
000   011
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 2</h3><pre>4 5
1 3 1
2 4 0
2 3 1
4 2 1
4 4 1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 2</h3><pre>32
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 3</h3><pre>3 5
1 3 1
3 3 0
3 1 0
2 3 1
3 2 1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 3</h3><pre>0
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 4</h3><pre>4 8
1 1 1
1 2 0
3 2 1
1 4 0
2 1 1
1 3 0
3 4 1
4 4 1
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 4</h3><pre>4
</pre>
</section>
</div>
<hr/>
<div class="part">
<section>
<h3>Sample Input 5</h3><pre>100000 0
</pre>
</section>
</div>
<div class="part">
<section>
<h3>Sample Output 5</h3><pre>342016343
</pre></section>
</div>
</span>